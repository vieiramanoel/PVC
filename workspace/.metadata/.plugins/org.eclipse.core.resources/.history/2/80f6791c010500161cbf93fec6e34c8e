#include "PointClickDistance.hpp"

int main(int argc, char** argv){
	cv::Mat image;
    PointClickDistance windowClick;


    windowClick.gettingROI();
    windowClick.getDistance();
    cv::VideoCapture cap(1);
    if (!cap.isOpened()) return -1;
    CvMat *intrinsic = (CvMat*)cvLoad("Intrinsics.xml");
    CvMat *distortion = (CvMat*)cvLoad("Distortion.xml");
    cap >> image;
    IplImage* mapx = cvCreateImage( image.size(), IPL_DEPTH_32F, 1 );
    IplImage* mapy = cvCreateImage( image.size(), IPL_DEPTH_32F, 1 );
	cvInitUndistortMap(intrinsic,distortion,mapx,mapy);
	cv::namedWindow("Undistort");
	while (true){
		cv::Mat t = image.clone();
		cv::imshow("Raw Video", image);
		cvRemap(&t, &image, mapx, mapy);
		cv::imshow("Undistort", image);
	}
    return 0;
}
